
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.1. The OCaml Toplevel &#8212; OCaml Programming: Correct + Efficient + Beautiful</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.c441f2ba0852f4cabcb80105e3a46ae6.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.2. Compiling OCaml Programs" href="compiling.html" />
    <link rel="prev" title="2. The Basics of OCaml" href="intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/lambda-light.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">OCaml Programming: Correct + Efficient + Beautiful</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../intro/intro.html">
   1. Better Programming Through OCaml
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/past.html">
     1.1. The Past of OCaml
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/present.html">
     1.2. The Present of OCaml
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/future.html">
     1.3. Look to Your Future
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/3110.html">
     1.4. A Brief History of CS 3110
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/summary.html">
     1.5. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/exercises.html">
     1.6. Exercises
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="intro.html">
   2. The Basics of OCaml
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.1. The OCaml Toplevel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="compiling.html">
     2.2. Compiling OCaml Programs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="expressions.html">
     2.3. Expressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functions.html">
     2.4. Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="documentation.html">
     2.5. Documentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="debugging.html">
     2.6. Debugging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="summary.html">
     2.7. Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="exercises.html">
     2.8. Exercises
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/basics/toplevel.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cs3110/textbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cs3110/textbook/issues/new?title=Issue%20on%20page%20%2Fchapters/basics/toplevel.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/cs3110/textbook/edit/jupyter/src/chapters/basics/toplevel.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-and-values">
   2.1.1. Types and values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   2.1.2. Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-code-in-the-toplevel">
   2.1.3. Loading code in the toplevel
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#workflow-in-the-toplevel">
   2.1.4. Workflow in the toplevel
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="the-ocaml-toplevel">
<h1><span class="section-number">2.1. </span>The OCaml Toplevel<a class="headerlink" href="#the-ocaml-toplevel" title="Permalink to this headline">¶</a></h1>
<p>The <em>toplevel</em> is like a calculator or command-line interface to OCaml. It’s
similar to JShell for Java, or the interactive Python interpreter. The toplevel
is handy for trying out small pieces of code without going to the trouble of
launching the OCaml compiler. But don’t get too reliant on it, because creating,
compiling, and testing large programs will require more powerful tools. Some
other languages would call the toplevel a <em>REPL</em>, which stands for
read-eval-print-loop: it reads programmer input, evaluates it, prints the
result, and then repeats.</p>
<p>In a terminal window, type <code class="docutils literal notranslate"><span class="pre">utop</span></code> to start the toplevel. Press Control-D to exit
the toplevel. You can also enter <code class="docutils literal notranslate"><span class="pre">#quit;;</span></code> and press return. Note that you must
type the <code class="docutils literal notranslate"><span class="pre">#</span></code> there: it is in addition to the <code class="docutils literal notranslate"><span class="pre">#</span></code> prompt you already see.</p>
<div class="section" id="types-and-values">
<h2><span class="section-number">2.1.1. </span>Types and values<a class="headerlink" href="#types-and-values" title="Permalink to this headline">¶</a></h2>
<p>You can enter expressions into the OCaml toplevel. End an expression with a
double semi-colon <code class="docutils literal notranslate"><span class="pre">;;</span></code> and press the return key. OCaml will then evaluate the
expression, tell you the resulting value, and the value’s type. For example:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="mi">42</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
<p>Let’s dissect that response from utop, reading right to left:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">42</span></code> is the value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> is the type of the value.</p></li>
<li><p>The value was not given a name, hence the symbol <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p></li>
</ul>
<p>You can bind values to names with a <code class="docutils literal notranslate"><span class="pre">let</span></code> definition, as follows:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">42</span><span class="o">;;</span>
<span class="k">val</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
<p>Again, let’s dissect that response, this time reading left to right:</p>
<ul class="simple">
<li><p>A value was bound to a name, hence the <code class="docutils literal notranslate"><span class="pre">val</span></code> keyword.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is the name to which the value was bound.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> is the type of the value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">42</span></code> is the value.</p></li>
</ul>
<p>You can pronounce the entire output as “<code class="docutils literal notranslate"><span class="pre">x</span></code> has type <code class="docutils literal notranslate"><span class="pre">int</span></code> and equals <code class="docutils literal notranslate"><span class="pre">42</span></code>.”</p>
</div>
<div class="section" id="functions">
<h2><span class="section-number">2.1.2. </span>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>A function can be defined at the toplevel using syntax like this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="k">let</span> <span class="n">increment</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="o">;;</span>
<span class="k">val</span> <span class="n">increment</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Let’s dissect that response:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">increment</span></code> is the identifier to which the value was bound.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">-&gt;</span> <span class="pre">int</span></code> is the type of the value. This is the type of functions that take
an <code class="docutils literal notranslate"><span class="pre">int</span></code> as input and produce an <code class="docutils literal notranslate"><span class="pre">int</span></code> as output. Think of the arrow <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> as a
kind of visual metaphor for the transformation of one value into another
value—which is what functions do.</p></li>
<li><p>The value is a function, which the toplevel chooses not to print (because it
has now been compiled and has a representation in memory that isn’t easily
amenable to pretty printing). Instead, the toplevel prints <code class="docutils literal notranslate"><span class="pre">&lt;fun&gt;</span></code>, which is
just a placeholder.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;fun&gt;</span></code> itself is not a value. It just indicates an unprintable function value.</p>
</div>
<p>You can “call” functions with syntax like this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">increment</span> <span class="mi">0</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">#</span> <span class="n">increment</span><span class="o">(</span><span class="mi">21</span><span class="o">);;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">22</span>
<span class="o">#</span> <span class="n">increment</span> <span class="o">(</span><span class="n">increment</span> <span class="mi">5</span><span class="o">);;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
<p>But in OCaml the usual vocabulary is that we “apply” the function rather than
“call” it.</p>
<p>Note how OCaml is flexible about whether you write the parentheses or not, and
whether you write whitespace or not. One of the challenges of first learning
OCaml can be figuring out when parentheses are actually required. So if you find
yourself having problems with syntax errors, one strategy is to try adding some
parentheses.</p>
</div>
<div class="section" id="loading-code-in-the-toplevel">
<h2><span class="section-number">2.1.3. </span>Loading code in the toplevel<a class="headerlink" href="#loading-code-in-the-toplevel" title="Permalink to this headline">¶</a></h2>
<p>In addition to allowing you to define functions, the toplevel will also accept
<em>directives</em> that are not OCaml code but rather tell the toplevel itself to do
something. All directives begin with the <code class="docutils literal notranslate"><span class="pre">#</span></code> character. Perhaps the most common
directive is <code class="docutils literal notranslate"><span class="pre">#use</span></code>, which loads all the code from a file into the toplevel,
just as if you had typed the code from that file into the toplevel.</p>
<p>For example, suppose you create a file named <code class="docutils literal notranslate"><span class="pre">mycode.ml</span></code>. In that file put the
following code:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">inc</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Start the toplevel. Try entering the following expression, and observe the
error:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">inc</span> <span class="mi">3</span><span class="o">;;</span>
<span class="nc">Error</span><span class="o">:</span> <span class="nc">Unbound</span> <span class="k">value</span> <span class="n">inc</span>
<span class="nc">Hint</span><span class="o">:</span> <span class="nc">Did</span> <span class="n">you</span> <span class="n">mean</span> <span class="n">incr</span><span class="o">?</span>
</pre></div>
</div>
<p>The error occurs because the toplevel does not yet know anything about a
function named <code class="docutils literal notranslate"><span class="pre">inc</span></code>. Now issue the following directive to the toplevel:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="o">#</span><span class="n">use</span> <span class="s2">&quot;mycode.ml&quot;</span><span class="o">;;</span>
</pre></div>
</div>
<p>Note that the first <code class="docutils literal notranslate"><span class="pre">#</span></code> character above indicates the toplevel prompt to you.
The second <code class="docutils literal notranslate"><span class="pre">#</span></code> character is one that you type to tell the toplevel that you are
issuing a directive. Without that character, the toplevel would think that you
are trying to apply a function named <code class="docutils literal notranslate"><span class="pre">use</span></code>.</p>
<p>Now try again:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">inc</span> <span class="mi">3</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="section" id="workflow-in-the-toplevel">
<h2><span class="section-number">2.1.4. </span>Workflow in the toplevel<a class="headerlink" href="#workflow-in-the-toplevel" title="Permalink to this headline">¶</a></h2>
<p>The best workflow when using the toplevel with code stored in files is:</p>
<ul class="simple">
<li><p>Edit the code in the file.</p></li>
<li><p>Load the code in the toplevel with <code class="docutils literal notranslate"><span class="pre">#use</span></code>.</p></li>
<li><p>Interactively test the code.</p></li>
<li><p>Exit the toplevel.  <strong>Warning:</strong> do not skip this step.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Suppose you wanted to fix a bug in your code. It’s tempting to not exit the
toplevel, edit the file, and re-issue the <code class="docutils literal notranslate"><span class="pre">#use</span></code> directive into the same
toplevel session. Resist that temptation. The “stale code” that was loaded from
an earlier <code class="docutils literal notranslate"><span class="pre">#use</span></code> directive in the same session can cause surprising things to
happen—surprising when you’re first learning the language, anyway. So
<strong>always exit the toplevel before re-using a file.</strong></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/basics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page"><span class="section-number">2. </span>The Basics of OCaml</a>
    <a class='right-next' id="next-link" href="compiling.html" title="next page"><span class="section-number">2.2. </span>Compiling OCaml Programs</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Michael R. Clarkson et al.<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>